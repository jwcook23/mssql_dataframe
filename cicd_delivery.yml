# Azure Pipelines Continuous Deployment that runs automatically after a pull request is complete. 
# Steps performed are essentially the same as the CI pipeline, but require a comment to be made
# after the pull request before the build continues. Additional the package is uploaded to PyPI.
# TODO: document pull request along with comment that is needed
#
# See Also
# --------
# CONTRIBUTING.md CICD Build Pipelines for a general overview of the CICD process
# continuous_integration.py and continuous_integration.yml for the core of the CI process

pool: 
      vmImage: windows-latest


jobs:
  - job: ContinuousDelivery
    steps:
      - task: PowerShell@2
        displayName: Set Package Version
        inputs:
          targetType: inline
          script: git describe --tags (git rev-list --tags --max-count=1) 
      # - template: cicd_template.yml
      # - task: TwineAuthenticate@1
      #   displayName: Twine Authenticate
      #   inputs:
      #     artifactFeed: mssql_dataframe/mssql_dataframe
      # - script: |
      #     $(Build.SourcesDirectory)\env\Scripts\python.exe -m twine upload -r mssql_dataframe --config-file $(PYPIRC_PATH) dist/*.whl
      #   displayName: Upload Artifact
      #   condition: eq(variables['build.sourceBranch'], 'refs/heads/main')